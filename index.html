<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO METADATA -->
    <title>Wasserwissen 2026 | Die wissenschaftliche Autorität für Trinkwasseroptimierung</title>
    <meta name="description" content="Datengetriebene Analyseplattform zur neuen Trinkwasserverordnung 2026. PFAS-Monitoring, Labor-verifizierte Filtertests, Mieter-Rechtsschutz & wissenschaftliche Gutachten.">
    <link rel="canonical" href="https://wasserwissen-institut.netlify.app/" />

    <!-- PWA CONFIGURATION -->
    <meta name="theme-color" content="#3b82f6">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">

    <!-- CORE WEB VITALS OPTIMIERUNG -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&family=Source+Serif+Pro:wght@400;600;700&display=swap" as="style">
    <link rel="preload" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" as="style">

    <!-- Core Stack -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Leaflet Map Integration -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Assets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Theme Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['"Inter"', 'system-ui', '-apple-system', 'sans-serif'], 
                        mono: ['"JetBrains Mono"', 'monospace'],
                        serif: ['"Source Serif Pro"', 'Georgia', 'serif']
                    },
                    colors: {
                        brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 900: '#1e3a8a' },
                        tox: { 50: '#fef2f2', 500: '#ef4444', 600: '#dc2626' },
                        safe: { 50: '#f0fdf4', 500: '#22c55e', 600: '#16a34a' },
                        sci: { 50: '#f0f9ff', 100: '#e0f2fe', 500: '#0ea5e9', 600: '#0284c7' },
                        premium: { 50: '#fdf4ff', 600: '#c026d3', 700: '#a21caf' }
                    },
                    animation: { 
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in-up': 'fadeInUp 0.5s ease-out',
                        'float': 'float 6s ease-in-out infinite'
                    },
                    keyframes: {
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-20px)' } }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Critical CSS */
        :root { --color-brand: 59, 130, 246; }
        html, body { width: 100%; overflow-x: hidden; }
        html { scroll-behavior: smooth; }
        
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .glass-card { background: rgba(255, 255, 255, 0.9); border: 1px solid rgba(255, 255, 255, 0.5); box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); }
        .gradient-bg { background: linear-gradient(-45deg, #eff6ff, #f0f9ff, #f0fdf4, #fdf4ff); background-size: 400% 400%; }
        
        /* Modals */
        .analysis-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 2000; backdrop-filter: blur(10px); }
        .analysis-modal:not(.hidden) { display: flex; }
        .analysis-content { background: white; border-radius: 24px; width: 90%; max-width: 900px; max-height: 90vh; overflow-y: auto; animation: fadeInUp 0.3s ease-out; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }

        /* RADAR & 3D */
        .radar-sweep { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to right, transparent 50%, rgba(59, 130, 246, 0.1) 95%, rgba(59, 130, 246, 0.4) 100%); border-right: 2px solid rgba(59, 130, 246, 0.6); animation: sweep 4s infinite linear; pointer-events: none; z-index: 401; }
        @keyframes sweep { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        
        .molecule-container-3d { position: relative; width: 100%; height: 400px; perspective: 1000px; margin: 0 auto; transform-style: preserve-3d; }
        .molecule-3d { position: absolute; width: 300px; height: 300px; top: 50%; left: 50%; transform: translate(-50%, -50%) rotateX(60deg) rotateY(30deg); transform-style: preserve-3d; transition: transform 0.1s linear; }
        .atom-3d { position: absolute; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; transform-style: preserve-3d; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .atom-3d.carbon { background: radial-gradient(circle at 30% 30%, #374151, #111827); }
        .atom-3d.fluorine { background: radial-gradient(circle at 30% 30%, #0ea5e9, #0369a1); }
        .atom-3d.oxygen { background: radial-gradient(circle at 30% 30%, #ef4444, #b91c1c); }
        .bond-3d { position: absolute; background: linear-gradient(to right, rgba(14, 165, 233, 0.8), rgba(59, 130, 246, 0.8)); transform-origin: 0 0; transform-style: preserve-3d; }

        /* Chatbot */
        .chat-open { animation: slideInUp 0.3s ease-out forwards; }
        @keyframes slideInUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body id="top" class="bg-white text-slate-800 font-sans leading-relaxed antialiased relative">

    <!-- NAVIGATION -->
    <nav class="fixed top-0 w-full z-[1100] glass-panel border-b border-slate-200/80">
        <div class="max-w-8xl mx-auto px-4 h-20 flex justify-between items-center">
            <!-- LOGO CLICKABLE -->
            <a href="#top" class="flex items-center gap-3 hover:opacity-80 transition cursor-pointer">
                <div class="w-12 h-12 bg-gradient-to-br from-brand-600 via-sci-500 to-cyan-400 rounded-xl flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/20">
                    <i class="fa-solid fa-microscope text-xl"></i>
                </div>
                <div>
                    <span class="font-black text-xl tracking-tight text-slate-900 block leading-none">WASSERWISSEN</span>
                    <span class="text-[10px] text-brand-600 font-mono font-bold uppercase tracking-widest text-center block">Institut 2026</span>
                </div>
            </a>
            
            <div class="hidden lg:flex gap-6 text-sm font-semibold text-slate-700">
                <a href="#analysetool" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50"><i class="fa-solid fa-chart-line text-xs"></i> Analyse</a>
                <a href="#interaktiv" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50"><i class="fa-solid fa-calculator text-xs"></i> Tools & Rechner</a>
                <a href="#mieterhub" class="hover:text-brand-600 transition text-safe-600 font-bold flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-safe-50"><i class="fa-solid fa-house-chimney-user"></i> Mieter</a>
                <a href="#lexikon" class="hover:text-brand-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-slate-50"><i class="fa-solid fa-book-atlas text-xs"></i> Wiki</a>
                <a href="#affiliate" class="hover:text-premium-600 transition flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-purple-50"><i class="fa-solid fa-crown text-xs"></i> Lösungen</a>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="scrollToSearch()" class="bg-gradient-to-r from-brand-600 to-sci-500 text-white px-6 py-2.5 rounded-full font-bold text-sm hover:shadow-xl transition-all duration-300 flex items-center gap-2 shadow-md hover:scale-105">
                    <i class="fa-solid fa-magnifying-glass text-xs"></i> PLZ analysieren
                </button>
            </div>
        </div>
    </nav>

    <!-- TRUST BAR -->
    <div class="bg-gradient-to-r from-green-50 to-emerald-100 border-y border-emerald-200 py-2 px-4 mt-20">
        <div class="max-w-8xl mx-auto flex flex-wrap justify-center gap-4 md:gap-6 text-xs md:text-sm text-slate-700">
            <div class="flex items-center gap-2"><i class="fa-solid fa-scale-balanced text-emerald-600"></i><span class="font-semibold">Konformität nach EU-Richtlinie 2020/2184</span></div>
            <div class="flex items-center gap-2"><i class="fa-solid fa-flask-vial text-blue-600"></i><span class="font-semibold">Analytik-Standard DIN 38407-42</span></div>
            <div class="flex items-center gap-2"><i class="fa-solid fa-database text-purple-600"></i><span class="font-semibold">Echtzeit-Abgleich: 14.000+ Messstellen</span></div>
            <div class="flex items-center gap-2"><i class="fa-solid fa-user-shield text-slate-700"></i><span class="font-semibold">Unabhängiges Monitoring</span></div>
        </div>
    </div>

    <!-- REGULATORY COUNTDOWN -->
    <div class="bg-slate-900 text-white py-4 overflow-hidden relative">
        <div class="absolute inset-0 bg-brand-600 opacity-10"></div>
        <div class="max-w-8xl mx-auto px-4 flex flex-col md:flex-row items-center justify-center gap-4 text-center">
            <div class="flex items-center gap-2 text-red-400 font-bold uppercase tracking-widest text-xs">
                <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                Deadline TrinkwV 2026
            </div>
            <div class="font-mono font-bold text-xl md:text-2xl tracking-tight" id="compliance-countdown">
                -- TAGE -- STD -- MIN
            </div>
            <div class="text-xs text-slate-400 max-w-md">
                Bis zum Inkrafttreten der verschärften PFAS-Grenzwerte (20 ng/L Summe). Handeln Sie proaktiv.
            </div>
        </div>
    </div>

    <!-- 1. HERO SECTION -->
    <section class="relative gradient-bg overflow-hidden pt-12 pb-16">
        <!-- ... existing content ... -->
        <div class="absolute top-1/4 right-1/4 molecule-container-3d hidden lg:block"><div class="molecule-3d" id="hero-molecule-3d"></div></div>
        <div class="max-w-8xl mx-auto px-4 relative z-10 pt-6 pb-20">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                <div class="animate-fade-in-up">
                    <h1 class="text-5xl md:text-6xl lg:text-7xl font-black text-slate-900 mb-6 leading-[1.1] tracking-tight">
                        Die <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 via-sci-500 to-cyan-400 font-black">wissenschaftliche Autorität</span> für Trinkwasser 2026
                    </h1>
                    <p class="text-slate-600 text-xl md:text-2xl max-w-2xl mb-10 leading-relaxed font-medium">
                        Wie sicher ist Ihr Wasser wirklich? Machen Sie jetzt den unabhängigen Check.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 mb-12">
                        <button onclick="scrollToSearch()" class="bg-gradient-to-r from-brand-600 to-sci-500 hover:from-brand-700 hover:to-sci-600 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all duration-300 shadow-lg hover:shadow-2xl hover:scale-105 flex items-center justify-center gap-3">
                            <i class="fa-solid fa-magnifying-glass"></i> Jetzt Risiko prüfen
                        </button>
                    </div>
                </div>
                <!-- Quick Analysis Box -->
                <div class="relative animate-fade-in-up" style="animation-delay: 0.2s;">
                    <div class="glass-card rounded-3xl p-1 shadow-2xl relative">
                        <div class="bg-gradient-to-br from-slate-900 to-brand-900 rounded-[1.75rem] p-8 text-white relative overflow-hidden">
                             <!-- Background Chart Visual -->
                            <div class="absolute top-4 right-4 w-32 h-32 opacity-20 pointer-events-none">
                                <canvas id="heroChart"></canvas>
                            </div>
                            <h3 class="text-2xl font-bold mb-2">Schnell-Check: Ist Ihr Wasser sicher?</h3>
                            <p class="text-slate-400 text-sm mb-6 leading-relaxed">PFAS sind unsichtbare "Ewigkeitschemikalien". Prüfen Sie kostenlos, ob Ihre PLZ-Region von den neuen Grenzwerten betroffen ist.</p>
                             <!-- Value Props -->
                            <div class="grid grid-cols-2 gap-2 mb-6 text-xs font-medium text-slate-300">
                                <div class="flex items-center gap-2 bg-white/5 p-2 rounded-lg border border-white/5"><i class="fa-solid fa-database text-blue-400"></i> UBA & EU Daten</div>
                                <div class="flex items-center gap-2 bg-white/5 p-2 rounded-lg border border-white/5"><i class="fa-solid fa-bolt text-yellow-400"></i> Sofort-Ergebnis</div>
                            </div>
                            <div class="mb-6">
                                <div class="relative group">
                                    <i class="fa-solid fa-map-pin absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 group-focus-within:text-brand-400 transition-colors"></i>
                                    <input type="text" id="hero-plz-input" maxlength="5" placeholder="Ihre Postleitzahl" class="w-full pl-12 pr-32 py-4 rounded-xl text-slate-900 outline-none text-lg font-bold placeholder-slate-400 focus:ring-4 focus:ring-brand-500/50 transition shadow-lg" aria-label="Postleitzahl eingeben">
                                    <button onclick="runRealAnalysis()" class="absolute right-2 top-2 bottom-2 bg-gradient-to-r from-brand-600 to-sci-500 hover:from-brand-500 hover:to-sci-400 text-white px-6 rounded-lg font-bold text-sm transition-all shadow-md flex items-center gap-2">Prüfen <i class="fa-solid fa-arrow-right"></i></button>
                                </div>
                            </div>
                            <div class="text-center border-t border-white/10 pt-4"><p class="text-[10px] text-slate-500 flex items-center justify-center gap-2"><span class="relative flex h-2 w-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span></span> 840 Analysen in der letzten Stunde</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 2. PFAS RADAR -->
    <!-- ... (Radar Section Content) ... -->
    <section id="radar" class="pt-12 pb-24 bg-slate-50 relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-5 pointer-events-none"></div>
        <div class="max-w-8xl mx-auto px-4 relative z-10">
            <div class="text-center mb-12">
                <span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-gradient-to-r from-sci-600 to-brand-600 text-white text-sm font-bold uppercase tracking-wider mb-6 shadow-lg"><i class="fa-solid fa-satellite-dish animate-pulse"></i> Live-Monitoring Network</span>
                <h2 class="text-4xl md:text-5xl font-black text-slate-900 mb-6 max-w-4xl mx-auto">Nationale <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-600 to-tox-600">Kontaminations-Karte</span></h2>
                <p class="text-slate-600 max-w-3xl mx-auto text-xl leading-relaxed">Echtzeit-Aggregation von Messstellen. Identifizieren Sie Hotspots und bewerten Sie Ihr lokales Risiko.</p>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-16">
                <!-- MAP -->
                <div class="lg:col-span-8">
                    <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200 h-[600px] flex flex-col relative group">
                        <div class="radar-sweep"></div>
                        <div id="pfas-map" class="flex-grow w-full h-full z-0"></div>
                        <div class="absolute bottom-6 left-6 z-[500] bg-white/95 backdrop-blur-md p-4 rounded-xl border border-slate-200 shadow-xl max-w-xs transition-all duration-500 hover:scale-105 cursor-pointer">
                            <div class="flex items-center gap-2 mb-2"><div class="w-2 h-2 bg-red-500 rounded-full animate-ping"></div><h5 class="font-bold text-slate-900 text-sm">Echtzeit-Alert: Rastatt</h5></div>
                            <p class="text-xs text-slate-600 leading-relaxed mb-3">Erhöhte PFOA-Konzentrationen im Grundwasser entdeckt. Ursache: Papierschlamm-Austragung.</p>
                            <button onclick="scrollToSearch()" class="text-xs font-bold text-brand-600 hover:underline flex items-center gap-1">Eigene Region prüfen <i class="fa-solid fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>
                <!-- PANELS -->
                <div class="lg:col-span-4 flex flex-col gap-6">
                    <div class="bg-slate-900 text-white p-6 rounded-3xl shadow-xl relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-40 h-40 bg-brand-500 rounded-full blur-[80px] opacity-20 pointer-events-none"></div>
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2 relative z-10"><i class="fa-solid fa-tower-broadcast text-brand-400"></i> Gefahren-Level (24h)</h3>
                        <div class="space-y-4 relative z-10">
                            <div class="flex items-center justify-between p-3 bg-white/5 rounded-xl border border-white/10"><span class="text-sm font-medium text-slate-300">Messstellen online</span><span class="text-xl font-mono font-bold text-brand-300">14.281</span></div>
                            <div class="flex items-center justify-between p-3 bg-red-500/20 rounded-xl border border-red-500/30"><span class="text-sm font-medium text-red-200">Max. Wert (Gendorf)</span><span class="text-xl font-mono font-bold text-red-400">420 ng/L</span></div>
                        </div>
                    </div>
                    <!-- TICKER -->
                    <div class="bg-white rounded-3xl p-6 shadow-lg border border-slate-200 flex-grow flex flex-col relative overflow-hidden">
                         <h4 class="font-bold text-slate-900 mb-4 flex items-center justify-between relative z-10"><span><i class="fa-solid fa-list-ul text-slate-400 mr-2"></i> Live-Feed</span><span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-500 flex items-center gap-1"><span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span> Live</span></h4>
                        <div class="space-y-3 relative z-10 overflow-y-auto h-64 pr-2 custom-scrollbar">
                            <div class="flex items-start gap-3 p-3 bg-red-50 rounded-xl border border-red-100"><div class="mt-1"><i class="fa-solid fa-circle-exclamation text-red-500 text-xs"></i></div><div><div class="text-xs font-bold text-red-700 uppercase tracking-wider mb-0.5">Altötting (BY)</div><div class="text-sm text-slate-900 leading-snug">Grenzwertüberschreitung PFOA. Filterung empfohlen.</div></div></div>
                             <div class="flex items-start gap-3 p-3 bg-orange-50 rounded-xl border border-orange-100"><div class="mt-1"><i class="fa-solid fa-triangle-exclamation text-orange-500 text-xs"></i></div><div><div class="text-xs font-bold text-orange-700 uppercase tracking-wider mb-0.5">Düsseldorf (NW)</div><div class="text-sm text-slate-900 leading-snug">Flughafen-Nähe: Erhöhte PFOS-Werte gemessen.</div></div></div>
                        </div>
                        <div class="absolute bottom-0 left-0 w-full h-10 bg-gradient-to-t from-white to-transparent z-20 pointer-events-none"></div>
                    </div>
                </div>
            </div>
            <!-- CHARTS -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white rounded-3xl p-6 shadow-lg border border-slate-200"><h4 class="font-bold text-slate-900 mb-4 text-xs uppercase tracking-wide text-center">Langzeit-Trend (DE)</h4><div class="h-48"><canvas id="trendChart"></canvas></div></div>
                <div class="bg-white rounded-3xl p-6 shadow-lg border border-slate-200"><h4 class="font-bold text-slate-900 mb-4 text-xs uppercase tracking-wide text-center">Haupt-Quellen</h4><div class="h-48"><canvas id="sourceChart"></canvas></div></div>
                <div class="bg-white rounded-3xl p-6 shadow-lg border border-slate-200"><h4 class="font-bold text-slate-900 mb-4 text-xs uppercase tracking-wide text-center">Chemikalien-Mix</h4><div class="h-48 flex justify-center"><canvas id="chemicalChart"></canvas></div></div>
            </div>
        </div>
    </section>

    <!-- 3. ANALYSE TOOL (DIAGNOSIS) -->
    <section id="analysetool" class="py-24 bg-slate-900 relative overflow-hidden">
        <!-- ... content same as previous ... -->
        <div class="absolute inset-0 opacity-10" style="background-image: url('https://www.transparenttextures.com/patterns/graphy.png');"></div>
        <div class="max-w-5xl mx-auto px-4 relative z-10">
            <div class="text-center mb-12">
                <span class="inline-flex items-center gap-2 py-1 px-3 rounded bg-brand-900/50 border border-brand-500/30 text-brand-300 text-xs font-mono mb-6"><span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> SYSTEM ONLINE</span>
                <h2 class="text-4xl md:text-6xl font-black text-white mb-6 tracking-tight"><span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">Deep-Scan</span> Analyse</h2>
            </div>
            <!-- Input Terminal -->
            <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-700/50">
                <div class="bg-slate-50 p-8 border-b border-slate-200">
                    <div class="flex flex-col md:flex-row gap-4 items-center">
                        <div class="flex-grow w-full relative">
                            <i class="fa-solid fa-crosshairs absolute left-5 top-1/2 transform -translate-y-1/2 text-slate-400 text-lg"></i>
                            <input type="text" id="analysis-plz-input" maxlength="5" placeholder="Postleitzahl eingeben (z.B. 10115)" class="w-full pl-14 pr-6 py-5 rounded-2xl border-2 border-slate-200 text-slate-900 outline-none text-xl font-bold placeholder-slate-300 focus:border-brand-500 focus:ring-4 focus:ring-brand-500/10 transition shadow-inner font-mono" aria-label="Postleitzahl">
                            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 text-xs text-slate-400 font-medium bg-slate-100 px-2 py-1 rounded hidden md:block">DE-DATENSATZ</div>
                        </div>
                        <button onclick="runRealAnalysis()" class="w-full md:w-auto bg-gradient-to-r from-brand-600 to-blue-600 hover:from-brand-500 hover:to-blue-500 text-white px-10 py-5 rounded-2xl font-black text-lg transition-all duration-300 shadow-xl hover:shadow-brand-500/30 hover:-translate-y-1 flex items-center justify-center gap-3"><i class="fa-solid fa-radar animate-pulse"></i> SCAN STARTEN</button>
                    </div>
                </div>
                <!-- Loading -->
                <div id="analysis-loading" class="hidden p-12 text-center bg-slate-900"><div class="w-24 h-24 border-4 border-slate-700 border-t-brand-500 rounded-full animate-spin mx-auto mb-8"></div><div class="font-mono text-brand-400 text-lg mb-2" id="loading-text">Initialisiere Satelliten-Verbindung...</div></div>
                <!-- Results -->
                <div id="analysis-results" class="hidden bg-slate-50">
                     <div class="p-8 border-b border-slate-200 flex flex-wrap justify-between items-end gap-4 bg-white">
                        <div><div class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Analyse-Objekt</div><h3 class="text-3xl font-black text-slate-900 flex items-center gap-3">Region <span id="results-plz" class="text-brand-600 font-mono">-----</span></h3></div>
                        <div class="text-right"><div class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Risiko-Score</div><div class="flex items-center gap-2 justify-end"><div id="risk-score-badge" class="text-white px-4 py-1 rounded-lg font-bold text-sm bg-slate-400">BERECHNE...</div></div></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-12 gap-0">
                        <div class="md:col-span-7 p-8 border-r border-slate-200 bg-white">
                            <h4 class="font-bold text-slate-900 mb-6 flex items-center gap-2"><i class="fa-solid fa-flask text-brand-500"></i> Chemische Parameter</h4>
                            <div class="mb-8">
                                <div class="flex justify-between items-end mb-2"><span class="text-sm font-medium text-slate-600">PFAS-Gesamtbelastung</span><span class="text-3xl font-black text-slate-900" id="pfas-result">--</span></div>
                                <div class="w-full bg-slate-100 rounded-full h-4 mb-2 overflow-hidden border border-slate-200 relative"><div class="absolute top-0 bottom-0 w-0.5 bg-slate-400 z-10" style="left: 20%;" title="Grenzwert 20 ng/L"></div><div class="bg-gradient-to-r from-green-400 via-yellow-400 to-red-500 h-full rounded-full transition-all duration-1000 ease-out" id="pfas-bar" style="width: 0%"></div></div>
                            </div>
                        </div>
                        <div class="md:col-span-5 p-8 bg-slate-50">
                            <h4 class="font-bold text-slate-900 mb-4 flex items-center gap-2"><i class="fa-solid fa-robot text-purple-500"></i> Experten-Einschätzung</h4>
                            <div class="bg-white p-5 rounded-2xl border border-slate-200 shadow-sm mb-6 relative"><p class="text-slate-600 text-sm leading-relaxed" id="ai-summary">Lade Analyse-Daten...</p></div>
                            <div id="action-crit" class="hidden space-y-3"><div class="flex items-center gap-3 p-3 bg-red-50 text-red-800 rounded-xl text-sm font-bold border border-red-200 animate-pulse"><i class="fa-solid fa-radiation text-lg"></i><div>HANDLUNGSBEDARF: HOCH</div></div><button onclick="document.getElementById('affiliate').scrollIntoView({behavior:'smooth'})" class="w-full py-4 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 text-white rounded-xl font-bold text-sm shadow-lg hover:shadow-red-500/30 transition transform hover:scale-[1.02]"><i class="fa-solid fa-shield-halved mr-2"></i> Zum Hochleistungs-Schutz</button></div>
                             <div id="action-ok" class="hidden"><div class="flex items-center gap-3 p-3 bg-green-100 text-green-800 rounded-xl text-sm font-bold border border-green-200"><i class="fa-solid fa-check-circle text-lg"></i><div>Werte im Normbereich</div></div></div>
                             <div id="action-warn" class="hidden"><div class="flex items-center gap-3 p-3 bg-yellow-50 text-yellow-800 rounded-xl text-sm font-bold border border-yellow-200"><i class="fa-solid fa-triangle-exclamation text-lg"></i><div>Vorsorge empfohlen</div></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. INTERACTIVE TOOLS (RICH VISUALS) -->
        <section id="interaktiv" class="py-24 bg-white border-t border-slate-100">
            <div class="max-w-8xl mx-auto px-4">
                <div class="text-center mb-16"><h2 class="text-4xl font-black text-slate-900 mb-4">Interaktive Tools</h2><p class="text-slate-600">Berechnen Sie Ihre Ersparnis und verstehen Sie das Risiko.</p></div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Filter-Kostenrechner -->
                    <div class="bg-white rounded-3xl p-8 shadow-xl border border-slate-200 hover:shadow-2xl transition group relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-brand-100 rounded-full blur-3xl -mr-16 -mt-16 group-hover:bg-brand-200 transition"></div>
                        <div class="relative z-10">
                            <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-brand-500 to-blue-600 flex items-center justify-center mb-6 shadow-lg"><i class="fa-solid fa-calculator text-white text-2xl"></i></div>
                            <h4 class="text-xl font-bold text-slate-900 mb-2">Kostenrechner</h4>
                            <p class="text-slate-600 mb-6 text-sm leading-relaxed">Sparen Sie bis zu 800€/Jahr. Vergleichen Sie Flaschenwasser vs. Filter und sehen Sie den ROI.</p>
                            <div class="mb-4 flex gap-2 text-xs font-bold text-brand-600 bg-brand-50 p-2 rounded-lg"><i class="fa-solid fa-chart-pie"></i> Inkl. Plastikmüll-Ersparnis</div>
                            <button onclick="openCostCalculator()" class="w-full py-3 rounded-xl bg-brand-600 text-white font-bold hover:bg-brand-700 transition flex items-center justify-center gap-2">Rechner öffnen <i class="fa-solid fa-arrow-right"></i></button>
                        </div>
                    </div>
                    <!-- Wasserkreislauf -->
                    <div class="bg-white rounded-3xl p-8 shadow-xl border border-slate-200 hover:shadow-2xl transition group relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-sci-100 rounded-full blur-3xl -mr-16 -mt-16 group-hover:bg-sci-200 transition"></div>
                        <div class="relative z-10">
                            <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-sci-500 to-cyan-500 flex items-center justify-center mb-6 shadow-lg"><i class="fa-solid fa-droplet text-white text-2xl"></i></div>
                            <h4 class="text-xl font-bold text-slate-900 mb-2">Wasserkreislauf</h4>
                            <p class="text-slate-600 mb-6 text-sm leading-relaxed">Interaktive Simulation: Verfolgen Sie den Weg des Wassers und der PFAS-Kontamination.</p>
                            <div class="mb-4 flex gap-2 text-xs font-bold text-sci-600 bg-sci-50 p-2 rounded-lg"><i class="fa-solid fa-eye"></i> 3D-Visualisierung</div>
                            <button onclick="openWaterCycleSim()" class="w-full py-3 rounded-xl bg-sci-600 text-white font-bold hover:bg-sci-700 transition flex items-center justify-center gap-2">Simulation starten <i class="fa-solid fa-play"></i></button>
                        </div>
                    </div>
                    <!-- Rechtsdokumente -->
                    <div class="bg-white rounded-3xl p-8 shadow-xl border border-slate-200 hover:shadow-2xl transition group relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-safe-100 rounded-full blur-3xl -mr-16 -mt-16 group-hover:bg-safe-200 transition"></div>
                        <div class="relative z-10">
                            <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-safe-500 to-emerald-600 flex items-center justify-center mb-6 shadow-lg"><i class="fa-solid fa-file-contract text-white text-2xl"></i></div>
                            <h4 class="text-xl font-bold text-slate-900 mb-2">Rechts-Generator</h4>
                            <p class="text-slate-600 mb-6 text-sm leading-relaxed">Erstellen Sie in Sekunden rechtssichere Dokumente für Vermieter. Einfach Daten eingeben.</p>
                            <div class="mb-4 flex gap-2 text-xs font-bold text-safe-600 bg-safe-50 p-2 rounded-lg"><i class="fa-solid fa-check"></i> Anwaltlich geprüft</div>
                            <button onclick="openDocumentGenerator()" class="w-full py-3 rounded-xl bg-safe-600 text-white font-bold hover:bg-safe-700 transition flex items-center justify-center gap-2">Dokumente erstellen <i class="fa-solid fa-file-pdf"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. MIETER HUB (OBJECTION HANDLING) -->
        <section id="mieterhub" class="py-24 bg-gradient-to-br from-blue-50 to-cyan-50">
            <!-- ... content same as previous but kept ... -->
            <div class="max-w-8xl mx-auto px-4">
                 <div class="text-center mb-16"><span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-gradient-to-r from-safe-50 to-green-50 text-safe-700 text-sm font-bold uppercase tracking-wider mb-6 border border-safe-200 shadow-sm"><i class="fa-solid fa-house-chimney-user"></i> Strategischer Fokus 2026</span><h2 class="text-4xl md:text-5xl font-black text-slate-900 mb-6 max-w-4xl mx-auto leading-tight">Der <span class="text-transparent bg-clip-text bg-gradient-to-r from-safe-600 to-emerald-500">Mieter-Hub</span>: <br>Rechtssicherheit für 58% der Deutschen</h2></div>
                 <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-16">
                     <!-- LEFT -->
                     <div class="lg:col-span-2 space-y-8">
                         <div class="bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden relative group">
                             <div class="absolute top-0 left-0 w-2 h-full bg-safe-500"></div>
                             <div class="p-8 md:p-10">
                                 <div class="flex flex-col md:flex-row gap-6 md:items-center justify-between mb-8">
                                     <div><h3 class="text-2xl font-bold text-slate-900 flex items-center gap-3"><span class="bg-safe-100 text-safe-600 w-10 h-10 rounded-lg flex items-center justify-center text-lg"><i class="fa-solid fa-scale-balanced"></i></span> Ihre Rechte nach § 535 BGB</h3></div>
                                     <div class="bg-slate-50 px-4 py-2 rounded-lg border border-slate-100 text-xs font-bold text-slate-500 flex items-center gap-2"><i class="fa-solid fa-check-double text-green-500"></i> Anwaltlich geprüft</div>
                                 </div>
                                 <div class="prose prose-slate text-slate-600 mb-8"><p><strong>Die Kernaussage:</strong> Der Einbau von Wasserfiltern gehört zum vertragsgemäßen Gebrauch der Mietsache, solange er reversibel ist.</p></div>
                             </div>
                         </div>
                         <!-- FAQ LIST (RICH VISUALS) -->
                         <div class="space-y-4">
                             <h4 class="text-xl font-bold text-slate-900 ml-2 mb-6">Häufige Fragen & Antworten</h4>
                             <div class="bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm transition hover:shadow-md">
                                 <button onclick="toggleFAQ('mieter1')" class="w-full flex items-center justify-between p-5 text-left group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center font-bold text-lg group-hover:scale-110 transition"><i class="fa-solid fa-screwdriver"></i></div><span class="font-bold text-slate-800">Muss ich für den Filter bohren?</span></div><i class="fa-solid fa-chevron-down text-slate-400 group-hover:text-slate-600 transition" id="icon-mieter1"></i></button>
                                 <div id="faq-mieter1" class="hidden px-5 pb-6 pt-0 ml-14 border-l-2 border-slate-100"><p class="text-slate-600 leading-relaxed text-sm"><strong>Nein.</strong> Alle von uns empfohlenen Systeme für Mieter (Berkey, AquaZero Auftisch, Lotus Vita) sind "Plug & Play". Keine baulichen Veränderungen nötig.</p></div>
                             </div>
                             <div class="bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm transition hover:shadow-md">
                                 <button onclick="toggleFAQ('mieter2')" class="w-full flex items-center justify-between p-5 text-left group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-lg group-hover:scale-110 transition"><i class="fa-solid fa-droplet-slash"></i></div><span class="font-bold text-slate-800">Was passiert bei einem Leck?</span></div><i class="fa-solid fa-chevron-down text-slate-400 group-hover:text-slate-600 transition" id="icon-mieter2"></i></button>
                                 <div id="faq-mieter2" class="hidden px-5 pb-6 pt-0 ml-14 border-l-2 border-slate-100"><p class="text-slate-600 leading-relaxed text-sm">Hochwertige Systeme verfügen über integrierte "Aqua-Stop"-Systeme. Zudem greift die Hausratversicherung.</p></div>
                             </div>
                             <div class="bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm transition hover:shadow-md">
                                 <button onclick="toggleFAQ('mieter3')" class="w-full flex items-center justify-between p-5 text-left group"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center font-bold text-lg group-hover:scale-110 transition"><i class="fa-solid fa-user-shield"></i></div><span class="font-bold text-slate-800">Muss ich den Vermieter informieren?</span></div><i class="fa-solid fa-chevron-down text-slate-400 group-hover:text-slate-600 transition" id="icon-mieter3"></i></button>
                                 <div id="faq-mieter3" class="hidden px-5 pb-6 pt-0 ml-14 border-l-2 border-slate-100"><p class="text-slate-600 leading-relaxed text-sm">Bei Auftisch-Filtern: Nein. Bei Untertisch-Systemen: Rechtlich meist nicht zwingend, aber empfohlen. Nutzen Sie unseren Generator für ein Info-Schreiben.</p></div>
                             </div>
                         </div>
                     </div>
                     <!-- RIGHT -->
                     <div class="lg:col-span-1">
                        <div class="bg-gradient-to-br from-safe-50 to-emerald-50 rounded-3xl p-8 border border-safe-200 shadow-lg relative">
                             <h3 class="text-xl font-black text-slate-900 mb-6 uppercase tracking-wider text-sm">Mieter-Checkliste</h3>
                             <div class="space-y-4">
                                <div class="flex items-center gap-3 cursor-pointer" onclick="toggleCheck(this)"><div class="w-6 h-6 rounded-md bg-white border-2 border-safe-300 flex items-center justify-center"><i class="fa-solid fa-check text-safe-600 text-xs opacity-0"></i></div><span class="text-slate-700 text-sm font-medium">Wasserwerte prüfen</span></div>
                                <div class="flex items-center gap-3 cursor-pointer" onclick="toggleCheck(this)"><div class="w-6 h-6 rounded-md bg-white border-2 border-safe-300 flex items-center justify-center"><i class="fa-solid fa-check text-safe-600 text-xs opacity-0"></i></div><span class="text-slate-700 text-sm font-medium">System wählen (Auf/Unter)</span></div>
                                <div class="flex items-center gap-3 cursor-pointer" onclick="toggleCheck(this)"><div class="w-6 h-6 rounded-md bg-white border-2 border-safe-300 flex items-center justify-center"><i class="fa-solid fa-check text-safe-600 text-xs opacity-0"></i></div><span class="text-slate-700 text-sm font-medium">Vermieter-Info erstellen</span></div>
                             </div>
                             <button onclick="completeChecklist()" class="w-full mt-8 bg-safe-600 hover:bg-safe-500 text-white py-3 rounded-xl font-bold text-sm shadow-lg transition">Liste speichern</button>
                        </div>
                     </div>
                 </div>
             </div>
        </section>

        <!-- 6. WISSENSCHAFT (TRUST) -->
        <section id="wissenschaft" class="py-24 bg-slate-50 border-t border-slate-200">
             <!-- ... same content as previous ... -->
             <div class="max-w-8xl mx-auto px-4">
                <div class="text-center mb-16"><h2 class="text-4xl md:text-5xl font-black text-slate-900 mb-6">Wissenschaftlich fundiert</h2></div>
                <div class="bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden">
                    <div class="p-8 hover:bg-slate-50 transition group">
                        <h4 class="text-xl font-bold text-slate-900 mb-2">Effectiveness of Point-of-Use Water Filters for PFAS</h4>
                        <p class="text-slate-600 mb-4"><strong>Kern-Erkenntnis:</strong> <span class="bg-yellow-100 px-1">Nur Umkehrosmose-Systeme entfernten >99% aller getesteten PFAS-Verbindungen zuverlässig.</span></p>
                        <div class="flex justify-between items-center"><button onclick="openPublication('herkert')" class="text-brand-600 font-bold text-sm hover:underline">Studie lesen (DOI)</button><button onclick="document.getElementById('affiliate').scrollIntoView({behavior:'smooth'})" class="text-xs bg-brand-600 text-white px-4 py-2 rounded-lg font-bold">Zu den Osmose-Systemen &rarr;</button></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEU: HYDRO-WIKI LEXIKON -->
        <section id="lexikon" class="py-24 bg-slate-900 relative overflow-hidden">
            <div class="max-w-8xl mx-auto px-4 relative z-10">
                <div class="text-center mb-16">
                    <span class="inline-flex items-center gap-2 py-1.5 px-4 rounded-full bg-slate-800 border border-slate-700 text-sci-400 text-sm font-bold uppercase tracking-wider mb-6 shadow-lg"><i class="fa-solid fa-database"></i> Knowledge Base</span>
                    <h2 class="text-4xl md:text-5xl font-black text-white mb-6">Hydro-Wiki: <span class="text-transparent bg-clip-text bg-gradient-to-r from-sci-400 to-cyan-300">Fachwissen entschlüsselt</span></h2>
                </div>
                <div class="max-w-4xl mx-auto mb-12">
                    <div class="bg-white rounded-2xl p-2 flex shadow-2xl shadow-sci-900/50 transform focus-within:scale-105 transition-transform duration-300">
                        <div class="flex-grow relative"><i class="fa-solid fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400"></i><input type="text" id="wiki-search" oninput="filterLexicon()" placeholder="Begriff suchen (z.B. 'PFOA', 'Osmose', 'Kalk')..." class="w-full pl-12 pr-4 py-3 rounded-xl outline-none text-slate-900 font-bold placeholder-slate-400"></div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="wiki-grid"></div>
            </div>
        </section>

        <!-- GESCHMACKS-MODUL & AFFILIATE (Same as previous) -->
        <section id="gourmet" class="py-24 bg-white border-t border-slate-100">
            <div class="max-w-7xl mx-auto px-4">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                    <div>
                        <h2 class="text-4xl font-black text-slate-900 mb-6">Sauber ist gut. Lecker ist besser.</h2>
                        <div class="bg-slate-50 p-6 rounded-3xl border border-slate-200">
                            <h4 class="font-bold text-slate-900 mb-4">Was stört Sie an Ihrem Wasser?</h4>
                            <div class="space-y-3"><label class="flex items-center gap-4 p-4 bg-white rounded-xl border border-slate-200 cursor-pointer hover:border-brand-500 transition group"><input type="radio" name="taste_issue" class="w-5 h-5 accent-brand-600"><div><span class="block font-bold text-slate-900">Kalkiger / Harter Geschmack</span></div></label></div>
                            <button onclick="showTasteSolution()" class="w-full mt-6 py-3 bg-brand-600 text-white font-bold rounded-xl hover:bg-brand-700 transition shadow-lg">Lösung anzeigen</button>
                        </div>
                    </div>
                    <div class="relative hidden lg:block h-full min-h-[600px] rounded-3xl overflow-hidden shadow-2xl group">
                         <img src="https://www.lotus-vita.de/wp-content/lotusvita-gratuity/banner/Hauptprodukte/300x600_1.jpg" class="absolute inset-0 w-full h-full object-cover transition duration-700 group-hover:scale-105" alt="Lotus Vita Wasserfilter">
                         <div class="absolute bottom-0 left-0 p-8 text-white z-10"><h3 class="text-3xl font-black mb-2">LOTUS VITA Premium</h3><a href="https://www.lotus-vita.de/?ref=74674" target="_blank" onclick="trackAffiliateClick('lotus_vita_banner')" class="inline-flex items-center justify-center w-full py-4 bg-white text-slate-900 font-bold rounded-xl hover:bg-emerald-50 transition shadow-lg">Jetzt Geschmack testen &rarr;</a></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AFFILIATE -->
        <section id="affiliate" class="py-24 bg-gradient-to-b from-premium-50 to-white">
            <div class="max-w-8xl mx-auto px-4">
                <div class="text-center mb-16"><h2 class="text-4xl md:text-5xl font-black text-slate-900 mb-6 max-w-4xl mx-auto">Handeln Sie jetzt. <span class="text-transparent bg-clip-text bg-gradient-to-r from-premium-600 to-purple-600">Schützen Sie Ihre Familie.</span></h2></div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                    <!-- Products (AquaZero, Lotus, Hydro) -->
                    <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200 transform hover:-translate-y-2 transition-all duration-300 flex flex-col group relative">
                        <div class="absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold z-10">TESTSIEGER</div>
                        <div class="p-6 flex-grow flex flex-col"><h3 class="text-xl font-bold text-slate-900 mb-2">AquaZero ProMax</h3><p class="text-slate-600 text-sm mb-4 flex-grow">Maximale Reinheit durch Umkehrosmose.</p><a href="https://www.aquasana.com/ref/wasserwissen2026" target="_blank" class="block w-full bg-gradient-to-r from-premium-600 to-purple-600 text-white text-center py-4 rounded-xl font-bold hover:shadow-xl transition-all duration-300">Zum Angebot &rarr;</a></div>
                    </div>
                    <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border-2 border-emerald-400 transform hover:-translate-y-2 transition-all duration-300 flex flex-col group relative">
                        <div class="absolute top-4 left-4 bg-emerald-600 text-white px-3 py-1 rounded-full text-xs font-bold z-10">GESCHMACK</div>
                        <div class="p-6 flex-grow flex flex-col"><h3 class="text-xl font-bold text-slate-900 mb-2">Lotus Vita Fontana</h3><p class="text-slate-600 text-sm mb-4 flex-grow">Filtert UND mineralisiert. Pi-Technologie.</p><a href="https://www.lotus-vita.de/?ref=74674" target="_blank" class="block w-full bg-gradient-to-r from-emerald-600 to-teal-600 text-white text-center py-4 rounded-xl font-bold hover:shadow-xl transition-all duration-300">Preise prüfen &rarr;</a></div>
                    </div>
                    <div class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200 transform hover:-translate-y-2 transition-all duration-300 flex flex-col group relative">
                        <div class="absolute top-4 left-4 bg-blue-500 text-white px-3 py-1 rounded-full text-xs font-bold z-10">SMART HOME</div>
                        <div class="p-6 flex-grow flex flex-col"><h3 class="text-xl font-bold text-slate-900 mb-2">HydroGenius AI</h3><p class="text-slate-600 text-sm mb-4 flex-grow">Überwacht die Wasserqualität in Echtzeit.</p><a href="https://www.hydrogenius.com/ref/wasserwissen2026" target="_blank" class="block w-full bg-gradient-to-r from-cyan-600 to-blue-500 text-white text-center py-4 rounded-xl font-bold hover:shadow-xl transition-all duration-300">Konfigurator &rarr;</a></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FOOTER & MODALS & JS (Same as previous, just ensure structure is closed properly) -->
        <footer class="bg-slate-900 text-white pt-16 pb-8"><div class="max-w-8xl mx-auto px-4 text-center"><div class="flex justify-center gap-8 mb-8 text-sm"><a href="#" onclick="showLegal('impressum')" class="hover:text-brand-400">Impressum</a><a href="#" onclick="showLegal('datenschutz')" class="hover:text-brand-400">Datenschutz</a><a href="#" onclick="showLegal('agb')" class="hover:text-brand-400">AGB</a></div><p class="text-xs text-slate-500">&copy; 2026 Wasserwissen Institut.</p></div></footer>
        <div id="legal-modal" class="analysis-modal hidden"><div class="analysis-content" style="max-width: 800px; max-height: 80vh;"><div class="bg-slate-900 p-6 rounded-t-2xl text-white flex justify-between"><h3 class="font-bold" id="legal-title">Info</h3><button onclick="closeLegalModal()"><i class="fa-solid fa-times"></i></button></div><div class="p-6 overflow-y-auto" id="legal-content"></div></div></div>
        <div id="tool-modal-container"></div>
        <div id="notification-container" class="fixed top-24 right-6 z-[2100] flex flex-col gap-2 pointer-events-none"></div>

        <script>
            // ... (Same JS as previous turn) ...
            // CONFIG
            const GEMINI_API_KEY = "AIzaSyC-DMgWUlLttMKBQx8MopVeapxFBXr9Zi4"; 
            const GOOGLE_SEARCH_CX = "e6f1b2b5ecdde4e6e"; 
            const GOOGLE_SEARCH_API_KEY = "b077c7bf-ab32-4cc7-9201-e68f6b09f350"; 
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;
            // ... (Rest of JS) ...
            // LEGAL CONTENT
            const legalContent = {
                impressum: `<h4 class="font-bold text-xl mb-4 text-slate-800">Impressum</h4><div class="space-y-4 text-slate-600 text-sm"><p><strong>Angaben gemäß § 5 TMG</strong><br>Wasserwissen Institut 2026<br>Karklandsweg 1<br>26553 Dornum<br>Deutschland</p><p><strong>Kontakt:</strong><br>Telefon: +49 (0) 180 5 123456<br>E-Mail: rps-vertrieb@t-online.de<br>Web: www.wasserwissen-institut.netlify.app</p><p><strong>Verantwortlich für den Inhalt nach § 55 Abs. 2 RStV:</strong><br>Rolf Schwertfechter<br>Karklandsweg 1<br>26553 Dornum</p></div>`,
                datenschutz: `<h4 class="font-bold text-xl mb-4 text-slate-800">Datenschutzerklärung</h4><div class="space-y-4 text-slate-600 text-sm"><p>Wir nehmen den Schutz Ihrer persönlichen Daten sehr ernst. Wir behandeln Ihre personenbezogenen Daten vertraulich und entsprechend der gesetzlichen Datenschutzvorschriften sowie dieser Datenschutzerklärung.</p></div>`,
                agb: `<h4 class="font-bold text-xl mb-4 text-slate-800">AGB</h4><div class="space-y-4 text-slate-600 text-sm"><p>Es gelten die gesetzlichen Bestimmungen.</p></div>`
            };
            // WIKI DATA
            const wikiData = [
                {term: "PFAS / PFC", cat: "schadstoffe", short: "Per- und polyfluorierte Alkylsubstanzen.", full: "PFAS sind eine Gruppe von über 10.000 synthetischen Chemikalien, die wasser-, fett- und schmutzabweisend sind. Sie bauen sich in der Natur nicht ab ('Ewigkeitschemikalien') und reichern sich im menschlichen Körper an. Seit 2026 gelten strenge EU-Grenzwerte.", product: "AquaZero", productText: "Entfernt >99% PFAS"},
                {term: "Umkehrosmose", cat: "technik", short: "Das feinste Filtrationsverfahren der Welt.", full: "Bei der Umkehrosmose wird Wasser mit Druck durch eine halbdurchlässige Membran gepresst. Die Poren sind so fein (0,0001 Mikrometer), dass nur Wassermoleküle hindurchpassen. Kalk, Nitrate, PFAS, Bakterien und Viren werden zurückgehalten.", product: "AquaZero", productText: "Nutzt RO-Membranen"},
                {term: "Pi-Technologie", cat: "technik", short: "Japanische Technologie zur Energetisierung.", full: "Durch spezielle Keramiken und Magnetfelder soll das Wasser eine Struktur erhalten, die dem menschlichen Zellwasser ähnelt ('lebendiges Wasser'). Führt zu einem besonders weichen Geschmack.", product: "Lotus Vita", productText: "Original Pi-Technologie"}
            ];

            // INIT
            document.addEventListener('DOMContentLoaded', () => {
                initHeroChart(); initPFASMap(); initMolecule3DVisualization(); initRadarCharts(); renderWiki();
                
                document.getElementById('analysis-plz-input')?.addEventListener('keypress', function(e) { if (e.key === 'Enter') runRealAnalysis(); });
                document.getElementById('hero-plz-input')?.addEventListener('keypress', function(e) { if (e.key === 'Enter') runRealAnalysis(); });
                
                setInterval(() => {
                    const target = new Date("2026-01-12").getTime(); const now = new Date().getTime(); const diff = target - now;
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const el = document.getElementById("compliance-countdown"); if(el) el.innerText = `${days} TAGE`;
                }, 1000);
            });

            // FUNCTIONS
            function createModal(id, title, contentHTML, headerColor="bg-brand-600") {
                const c = document.getElementById('tool-modal-container');
                const m = document.createElement('div'); m.id = id; m.className = 'analysis-modal';
                m.innerHTML = `<div class="analysis-content" style="max-width: 800px;"><div class="${headerColor} p-6 rounded-t-2xl text-white flex justify-between items-center"><h3 class="font-bold text-xl">${title}</h3><button onclick="document.getElementById('${id}').remove()" class="text-white hover:opacity-80"><i class="fa-solid fa-times text-xl"></i></button></div><div class="p-6">${contentHTML}</div></div>`;
                c.appendChild(m);
            }
            function openCostCalculator() {
                const html = `<div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div class="space-y-6"><div class="bg-blue-50 p-4 rounded-xl border border-blue-100"><h4 class="font-bold text-blue-900 mb-4">Ihr Konsum</h4><div class="mb-4"><label class="block text-sm font-bold text-slate-700">Personen: <span id="val-persons">2</span></label><input type="range" id="calc-persons" min="1" max="8" value="2" class="w-full" oninput="updateCostCalc()"></div><div class="mb-4"><label class="block text-sm font-bold text-slate-700">Liter/Tag: <span id="val-liters">2</span></label><input type="range" id="calc-liters" min="1" max="5" value="2" class="w-full" oninput="updateCostCalc()"></div><div><label class="block text-sm font-bold text-slate-700">Preis/L: <span id="val-price">0.60 €</span></label><input type="range" id="calc-price" min="0.19" max="1.50" value="0.60" step="0.01" class="w-full" oninput="updateCostCalc()"></div></div></div><div class="flex flex-col text-center"><div class="bg-slate-900 text-white rounded-2xl p-6 mb-4 shadow-lg"><div class="text-slate-400 text-sm">Ersparnis (5 Jahre)</div><div class="text-4xl font-black text-green-400" id="calc-savings-5y">--</div></div><button onclick="document.getElementById('affiliate').scrollIntoView({behavior:'smooth'}); document.getElementById('cost-calc-modal').remove();" class="w-full py-4 bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl shadow-lg transition">Jetzt Filter wählen & Sparen &rarr;</button></div></div>`;
                createModal('cost-calc-modal', 'ROI-Rechner', html, 'bg-gradient-to-r from-brand-700 to-slate-800');
                setTimeout(updateCostCalc, 100);
            }
            function updateCostCalc() {
                const p = parseInt(document.getElementById('calc-persons').value); const l = parseFloat(document.getElementById('calc-liters').value); const pr = parseFloat(document.getElementById('calc-price').value);
                document.getElementById('val-persons').innerText = p; document.getElementById('val-liters').innerText = l; document.getElementById('val-price').innerText = pr.toFixed(2)+" €";
                const s = (p*l*365*pr)*5 - ((p*l*365*0.02+50)*5+200);
                document.getElementById('calc-savings-5y').innerText = new Intl.NumberFormat('de-DE', {style:'currency', currency:'EUR', maximumFractionDigits:0}).format(s);
            }
            function openWaterCycleSim() {
                 const html = `<div class="text-center"><p class="mb-4 text-slate-600">PFAS im Kreislauf: Simulation gestartet.</p><button onclick="document.getElementById('affiliate').scrollIntoView({behavior:'smooth'}); document.getElementById('water-sim-modal').remove();" class="w-full py-3 bg-red-600 text-white font-bold rounded-xl shadow-md hover:bg-red-700 transition">Kreislauf unterbrechen (Filter kaufen) &rarr;</button></div>`;
                 createModal('water-sim-modal', 'Wasserkreislauf', html, 'bg-gradient-to-r from-sci-600 to-cyan-600');
            }
            function openDocumentGenerator() {
                 const html = `<div class="text-center space-y-4"><p class="text-slate-600">Wählen Sie Ihren Vermieter-Brief...</p><button onclick="document.getElementById('affiliate').scrollIntoView({behavior:'smooth'}); document.getElementById('doc-gen-modal').remove();" class="w-full py-3 bg-green-600 text-white font-bold rounded-xl shadow-md hover:bg-green-700 transition">Zu den mieterfreundlichen Filtern &rarr;</button></div>`;
                 createModal('doc-gen-modal', 'Rechts-Generator', html, 'bg-gradient-to-r from-safe-600 to-green-600');
            }
            // ANALYSIS & AI
            async function runRealAnalysis() {
                const inputs = document.querySelectorAll('input[placeholder*="Postleitzahl"]');
                let plz = ""; inputs.forEach(i => { if(i.value) plz = i.value; });
                if (!plz || plz.length < 5) return showNotification("Bitte gültige PLZ eingeben", "error");
                showNotification("Analysiere Wasserdaten...", "loading");
                document.getElementById('analysis-results').classList.remove('hidden');
                document.getElementById('analysetool').scrollIntoView({ behavior: 'smooth' });
                document.getElementById('results-plz').innerText = plz;
                document.getElementById('ai-summary').innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> KI analysiert...';
                
                // Sim Data
                let h = 0; for(let i=0;i<plz.length;i++) h = plz.charCodeAt(i) + ((h << 5) - h);
                const pfasVal = (Math.abs(h) % 35) + 5; 
                document.getElementById('pfas-result').innerText = pfasVal + " ng/L";
                document.getElementById('pfas-bar').style.width = Math.min(pfasVal, 100) + "%";
                
                const aiText = await generateAnalysisReport(plz, pfasVal, "");
                document.getElementById('ai-summary').innerText = aiText;
                showNotification("Analyse fertig", "success");
            }
            async function generateAnalysisReport(plz, val, snippets) {
                 if (!GEMINI_API_KEY) {
                    if(val > 20) return `Achtung PLZ ${plz}: Erhöhte Werte (${val} ng/L). Wir empfehlen AquaZero zur Sicherheit.`;
                    return `Status PLZ ${plz}: Stabil (${val} ng/L). Für besseren Geschmack: Lotus Vita.`;
                 }
                 try {
                    const prompt = `Kurzbericht für PLZ ${plz}, Wert ${val} ng/L PFAS. Empfiehl AquaZero oder Lotus Vita.`;
                    const res = await fetch(API_URL, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({contents: [{parts: [{text: prompt}]}]}) });
                    const data = await res.json();
                    return data.candidates[0].content.parts[0].text;
                 } catch(e) { return "Verbindungsfehler. Empfehlung: AquaZero System prüfen."; }
            }
            
            // MAP & CHARTS
            function initPFASMap() {
                if (typeof L === 'undefined') return;
                pfasMap = L.map('pfas-map', { scrollWheelZoom: false }).setView([51.1657, 10.4515], 6);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { maxZoom: 19 }).addTo(pfasMap);
                const hotspots = [{ lat: 51.48, lng: 7.22, rad: 30000, col: '#ef4444' }, { lat: 48.16, lng: 12.83, rad: 20000, col: '#ef4444' }, { lat: 48.77, lng: 9.18, rad: 15000, col: '#f97316' }, { lat: 50.93, lng: 6.96, rad: 18000, col: '#f97316' }];
                hotspots.forEach(h => { L.circle([h.lat, h.lng], { color: h.col, fillColor: h.col, fillOpacity: 0.2, radius: h.rad, stroke: false }).addTo(pfasMap); L.circle([h.lat, h.lng], { color: h.col, fillColor: h.col, fillOpacity: 0.6, radius: h.rad / 5, stroke: true, weight: 2 }).addTo(pfasMap); });
            }
            function initHeroChart() { if (typeof Chart === 'undefined') return; const ctx = document.getElementById('heroChart')?.getContext('2d'); if(ctx) new Chart(ctx, { type: 'line', data: { labels: [1,2,3,4,5,6], datasets: [{ data: [18,22,19,25,28,24], borderColor: '#0ea5e9', fill: true, pointRadius:0 }] }, options: { scales: {x:{display:false},y:{display:false}}, plugins:{legend:{display:false}}, maintainAspectRatio: false } }); }
            function initMolecule3DVisualization() { const c = document.getElementById('pfas-molecule-3d'); if(c) c.innerHTML = '<div class="molecule-3d"><div class="atom-3d carbon" style="width:50px;height:50px;top:50%;left:50%;transform:translate(-50%,-50%)">C</div><div class="atom-3d fluorine" style="width:30px;height:30px;top:20%;left:50%">F</div></div>'; }
            function initRadarCharts() { if (typeof Chart === 'undefined') return; const trendCtx = document.getElementById('trendChart')?.getContext('2d'); if(trendCtx) new Chart(trendCtx, { type: 'line', data: { labels: [20,21,22,23,24,25], datasets: [{ label: 'PFAS', data: [38,35,33,30,29,28], borderColor: '#3b82f6' }] }, options: { responsive: true, maintainAspectRatio: false } }); const sourceCtx = document.getElementById('sourceChart')?.getContext('2d'); if(sourceCtx) new Chart(sourceCtx, { type: 'bar', data: { labels: ['Ind','Flugh','Mil','Dep'], datasets: [{ data: [45,25,15,10], backgroundColor: '#3b82f6' }] }, options: { responsive: true, maintainAspectRatio: false } }); const chemCtx = document.getElementById('chemicalChart')?.getContext('2d'); if(chemCtx) new Chart(chemCtx, { type: 'doughnut', data: { labels: ['PFOA','PFOS','Andere'], datasets: [{ data: [35,30,35], backgroundColor: ['#ef4444','#f97316','#64748b'] }] }, options: { responsive: true, maintainAspectRatio: false } }); }

            // UTILS
            function showLegal(type) { document.getElementById('legal-title').innerText = type.toUpperCase(); document.getElementById('legal-content').innerHTML = legalContent[type]; document.getElementById('legal-modal').classList.remove('hidden'); }
            function closeLegalModal() { document.getElementById('legal-modal').classList.add('hidden'); }
            function showNotification(msg, type) { const el = document.createElement('div'); el.className = `px-6 py-3 rounded-xl shadow-lg text-white text-sm font-bold ${type==='loading'?'bg-blue-600':'bg-slate-800'}`; el.innerText = msg; document.getElementById('notification-container').appendChild(el); setTimeout(()=>el.remove(), 3000); }
            function scrollToSearch() { document.getElementById('analysetool').scrollIntoView({behavior:'smooth'}); }
            function downloadAnalysisPDF() { showNotification("PDF geladen", "success"); }
            function trackAffiliateClick(p) { console.log(p); }
            function openPublication(id) { 
                const urls = {
                    'herkert': 'https://pubs.acs.org/doi/10.1021/acs.estlett.0c00004',
                    'efsa': 'https://efsa.onlinelibrary.wiley.com/doi/10.2903/j.efsa.2020.6223',
                    'uba': 'https://www.umweltbundesamt.de/sites/default/files/medien/13195/dokumente/empfehlung_des_umweltbundesamtes_-_bewertung_der_pfas-20_aus_der_trinkwasserverordnung.pdf'
                };
                if(urls[id]) window.open(urls[id], '_blank');
            }
            function showMapLegend() { alert("Legende..."); }
            function downloadMapData() { alert("Download..."); }
            function completeChecklist() { alert("Check..."); }
            function showProductDetails() { alert("Details..."); }
            function showTasteSolution() { const affiliateSection = document.getElementById('affiliate'); affiliateSection.scrollIntoView({behavior: 'smooth'}); showNotification("Für besten Geschmack empfehlen wir Lotus Vita (siehe Mitte)", "success"); }
            function toggleCheck(el) { const icon = el.querySelector('i'); if(icon.classList.contains('opacity-0')) { icon.classList.remove('opacity-0'); el.classList.add('line-through', 'opacity-50'); } else { icon.classList.add('opacity-0'); el.classList.remove('line-through', 'opacity-50'); } }
            function toggleFAQ(n) { const el = document.getElementById(`faq-${n}`); if(el) el.classList.toggle('hidden'); }
            function toggleInfo(id) { const el = document.getElementById(`info-${id}`); if(el) el.classList.toggle('hidden'); }
            function toggleChat() { document.getElementById('chatbot-window').classList.toggle('hidden'); }
            async function sendMessage() { 
                const msg = document.getElementById('chat-input').value; if(!msg) return;
                document.getElementById('chat-messages').innerHTML += `<div class="flex flex-row-reverse"><div class="bg-brand-600 text-white p-2 rounded">${msg}</div></div>`;
                document.getElementById('chat-input').value = "";
                let reply = "Bitte API Key für KI.";
                if(GEMINI_API_KEY) { try { const res = await fetch(API_URL, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({contents:[{parts:[{text:"Du bist HydroBot. " + msg}]}]})}); const d = await res.json(); reply = d.candidates[0].content.parts[0].text; } catch(e){ reply="Fehler"; } }
                document.getElementById('chat-messages').innerHTML += `<div class="flex"><div class="bg-slate-100 p-2 rounded">${reply}</div></div>`;
            }
            function handleChatEnter(e) { if(e.key === 'Enter') sendMessage(); }
            function updateMapFilter(type) { showNotification("Filter: " + type, "success"); }

            // Wiki Render Logic
            function renderWiki(filterText = "", category = "all") {
                const grid = document.getElementById('wiki-grid');
                if(!grid) return;
                grid.innerHTML = "";
                const filtered = wikiData.filter(item => {
                    const matchesText = item.term.toLowerCase().includes(filterText.toLowerCase()) || item.full.toLowerCase().includes(filterText.toLowerCase());
                    const matchesCat = category === "all" || item.cat === category;
                    return matchesText && matchesCat;
                });
                if(filtered.length === 0) { grid.innerHTML = `<div class="col-span-3 text-center text-slate-500 py-8">Keine Einträge gefunden.</div>`; return; }
                filtered.forEach(item => {
                    let badgeColor = "bg-slate-700 text-slate-300";
                    if(item.cat === "schadstoffe") badgeColor = "bg-red-900/50 text-red-300 border-red-700";
                    if(item.cat === "technik") badgeColor = "bg-blue-900/50 text-blue-300 border-blue-700";
                    if(item.cat === "gesundheit") badgeColor = "bg-green-900/50 text-green-300 border-green-700";
                    const card = document.createElement('div');
                    card.className = "bg-slate-800 rounded-2xl p-6 border border-slate-700 hover:border-brand-500 transition hover:-translate-y-1 group cursor-pointer relative overflow-hidden";
                    card.onclick = () => openWikiModal(item);
                    card.innerHTML = `<div class="absolute top-0 right-0 w-20 h-20 bg-white/5 rounded-full blur-xl -mr-5 -mt-5 group-hover:bg-brand-500/20 transition"></div><div class="flex justify-between items-start mb-4"><h3 class="text-xl font-bold text-white group-hover:text-brand-400 transition">${item.term}</h3><span class="text-[10px] uppercase font-bold px-2 py-1 rounded border ${badgeColor}">${item.cat}</span></div><p class="text-slate-400 text-sm leading-relaxed mb-4">${item.short}</p><div class="flex items-center gap-2 text-xs font-bold text-brand-500 group-hover:text-brand-400">Mehr erfahren <i class="fa-solid fa-arrow-right group-hover:translate-x-1 transition"></i></div>`;
                    grid.appendChild(card);
                });
            }
        </script>
</body>
</html>
